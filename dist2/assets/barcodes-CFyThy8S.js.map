{"version":3,"file":"barcodes-CFyThy8S.js","sources":["../../src/features/barcodes.js"],"sourcesContent":["// ‚îÄ‚îÄ BARCODES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\nexport function makeBarcodeValue(item) {\n  // Use SKU if available, otherwise pad item id to look like a barcode\n  return (item.sku || item.id).replace(/[^A-Za-z0-9\\-\\.\\ \\$\\/\\+\\%]/g, '').substring(0, 40) || 'ITEM';\n}\n\nexport function renderBarcode(svgEl, value) {\n  try {\n    JsBarcode(svgEl, value, {\n      format: 'CODE128',\n      width: 2,\n      height: 50,\n      displayValue: false,\n      margin: 0,\n      background: '#ffffff',\n      lineColor: '#000000',\n    });\n  } catch(e) {\n    // If value has unsupported chars, fall back to item id\n    JsBarcode(svgEl, 'FT' + value.replace(/[^A-Za-z0-9]/g,'').substring(0,20), {\n      format: 'CODE128', width: 2, height: 50, displayValue: false, margin: 0,\n      background: '#ffffff', lineColor: '#000000',\n    });\n  }\n}\n\nexport function renderDrawerBarcode(item) {\n  const wrap = document.getElementById('dBarcodeWrap');\n  if (!wrap) return;\n  const val = makeBarcodeValue(item);\n  wrap.innerHTML = `\n    <div class=\"barcode-wrap\">\n      <svg id=\"dBarcodeSvg\"></svg>\n      <div class=\"barcode-sku-lbl\">${val}</div>\n    </div>\n    <div class=\"barcode-actions\">\n      <button class=\"btn-secondary\" style=\"font-size:11px;padding:5px 10px\" onclick=\"printStickers(false,[activeDrawId])\">üè∑ Print Sticker</button>\n      <span style=\"font-size:10px;color:var(--muted)\">CODE128</span>\n    </div>`;\n  const svg = document.getElementById('dBarcodeSvg');\n  if (svg) renderBarcode(svg, val);\n}\n\n// ‚îÄ‚îÄ STICKER PRINT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\nexport function printStickers(selectedOnly, ids) {\n  let items;\n  if (ids) {\n    items = ids.map(id => inv.find(i => i.id === id)).filter(Boolean);\n  } else if (selectedOnly && sel.size) {\n    items = [...sel].map(id => inv.find(i => i.id === id)).filter(Boolean);\n  } else {\n    // All filtered items currently visible\n    const q = (document.getElementById('invSearch').value||'').toLowerCase();\n    items = inv.filter(i => {\n      const mq = !q || i.name.toLowerCase().includes(q) || (i.sku||'').toLowerCase().includes(q);\n      const mp = platFilt.size===0 || getPlatforms(i).some(p=>platFilt.has(p));\n      const _ic=(i.category||'').toLowerCase(); const mc=catFilt.size===0||[...catFilt].some(f=>f.toLowerCase()===_ic);\n      const ms = subcatFilt==='all' || (i.subcategory||'')===subcatFilt;\n      const mss = subsubcatFilt==='all' || (i.subtype||'')===subsubcatFilt;\n      return mq&&mp&&mc&&ms&&mss;\n    });\n  }\n  if (!items.length) { toast('No items to print', true); return; }\n\n  // Build inline SVG barcodes using canvas\n  const stickersHtml = items.map(item => {\n    const val   = makeBarcodeValue(item);\n    const price = '$' + Number(item.price||0).toFixed(2);\n    const imgHtml = getItemImages(item)[0]\n      ? `<img class=\"st-photo\" src=\"${getItemImages(item)[0]}\" alt=\"\">`\n      : '';\n    const cats = [item.category, item.subcategory, item.subtype].filter(Boolean).join(' ‚Ä∫ ');\n    return `\n      <div class=\"sticker\" data-sku=\"${val}\">\n        ${imgHtml}\n        <div class=\"st-name\">${item.name}</div>\n        ${cats ? `<div class=\"st-cat\">${cats}</div>` : ''}\n        <div class=\"st-meta\">\n          <span class=\"st-platform\">${getPlatforms(item).join(' ¬∑ ')}</span>\n          <span class=\"st-price\">${price}</span>\n        </div>\n        <div class=\"st-bc-wrap\">\n          <svg class=\"bc-svg\" data-val=\"${val}\"></svg>\n          <div class=\"st-sku\">${val}</div>\n        </div>\n      </div>`;\n  }).join('');\n\n  const win = window.open('', '_blank', 'width=900,height=700');\n  win.document.write(`<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"UTF-8\">\n<title>FlipTrack ‚Äî Inventory Stickers</title>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js\"><\\/script>\n<style>\n  * { box-sizing: border-box; margin: 0; padding: 0; }\n  body {\n    font-family: 'Courier New', monospace;\n    background: #f5f5f5;\n    padding: 16px;\n  }\n  .print-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 16px;\n    padding-bottom: 12px;\n    border-bottom: 2px solid #000;\n  }\n  .print-title { font-size: 20px; font-weight: 700; letter-spacing: 2px; }\n  .print-meta  { font-size: 11px; color: #666; }\n  .print-actions { display: flex; gap: 8px; }\n  .print-btn {\n    padding: 8px 18px;\n    background: #000;\n    color: #fff;\n    border: none;\n    cursor: pointer;\n    font-family: inherit;\n    font-size: 12px;\n    letter-spacing: 1px;\n    text-transform: uppercase;\n  }\n  .print-btn.sec { background: #fff; color: #000; border: 1px solid #000; }\n\n  .sticker-grid {\n    display: grid;\n    grid-template-columns: repeat(4, 1fr);\n    gap: 10px;\n  }\n\n  .sticker {\n    background: #fff;\n    border: 1.5px solid #000;\n    padding: 10px;\n    display: flex;\n    flex-direction: column;\n    gap: 5px;\n    page-break-inside: avoid;\n    break-inside: avoid;\n    min-height: 160px;\n  }\n  .st-photo {\n    width: 100%;\n    height: 70px;\n    object-fit: cover;\n    border: 1px solid #eee;\n    margin-bottom: 2px;\n  }\n  .st-name {\n    font-size: 11px;\n    font-weight: 700;\n    line-height: 1.3;\n    letter-spacing: 0.3px;\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n  }\n  .st-cat {\n    font-size: 8px;\n    color: #666;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n  .st-meta {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 2px;\n  }\n  .st-platform {\n    font-size: 8px;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    background: #f0f0f0;\n    padding: 2px 5px;\n    color: #333;\n  }\n  .st-price {\n    font-size: 14px;\n    font-weight: 700;\n    letter-spacing: 0.5px;\n  }\n  .st-bc-wrap {\n    margin-top: auto;\n    padding-top: 5px;\n    border-top: 1px dashed #ccc;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 2px;\n  }\n  .bc-svg { width: 100%; max-height: 44px; }\n  .st-sku {\n    font-size: 7.5px;\n    letter-spacing: 1.5px;\n    color: #444;\n    text-transform: uppercase;\n  }\n\n  @media print {\n    body { background: #fff; padding: 8px; }\n    .print-header .print-actions { display: none; }\n    .sticker-grid { gap: 6px; }\n    .sticker { border: 1px solid #000; }\n  }\n  @page { margin: 12mm; }\n</style>\n</head>\n<body>\n<div class=\"print-header\">\n  <div>\n    <div class=\"print-title\">FLIPTRACK ‚Äî INVENTORY STICKERS</div>\n    <div class=\"print-meta\">${items.length} item${items.length!==1?'s':''} ¬∑ Generated ${new Date().toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'})}</div>\n  </div>\n  <div class=\"print-actions\">\n    <button class=\"print-btn sec\" onclick=\"window.close()\">‚úï Close</button>\n    <button class=\"print-btn\" onclick=\"window.print()\">‚¨õ Print</button>\n  </div>\n</div>\n<div class=\"sticker-grid\">${stickersHtml}</div>\n<script>\n  window.onload = function() {\n    document.querySelectorAll('.bc-svg').forEach(svg => {\n      const val = svg.dataset.val;\n      try {\n        JsBarcode(svg, val, {\n          format: 'CODE128',\n          width: 1.5,\n          height: 40,\n          displayValue: false,\n          margin: 0,\n          background: '#ffffff',\n          lineColor: '#000000',\n        });\n      } catch(e) {\n        JsBarcode(svg, 'FT' + val.replace(/[^A-Za-z0-9]/g,'').substring(0,20), {\n          format:'CODE128', width:1.5, height:40, displayValue:false,\n          margin:0, background:'#ffffff', lineColor:'#000000'\n        });\n      }\n    });\n    // Auto-show print dialog after barcodes render\n    setTimeout(() => window.print(), 400);\n  };\n<\\/script>\n</body>\n</html>`);\n  win.document.close();\n}\n"],"names":["makeBarcodeValue","item","renderBarcode","svgEl","value","renderDrawerBarcode","wrap","val","svg","printStickers","selectedOnly","ids","items","id","i","q","mq","mp","p","_ic","mc","f","ms","mss","stickersHtml","price","imgHtml","cats","win"],"mappings":"AAEO,SAASA,EAAiBC,EAAM,CAErC,OAAQA,EAAK,KAAOA,EAAK,IAAI,QAAQ,8BAA+B,EAAE,EAAE,UAAU,EAAG,EAAE,GAAK,MAC9F,CAEO,SAASC,EAAcC,EAAOC,EAAO,CAC1C,GAAI,CACF,UAAUD,EAAOC,EAAO,CACtB,OAAQ,UACR,MAAO,EACP,OAAQ,GACR,aAAc,GACd,OAAQ,EACR,WAAY,UACZ,UAAW,SACjB,CAAK,CACH,MAAW,CAET,UAAUD,EAAO,KAAOC,EAAM,QAAQ,gBAAgB,EAAE,EAAE,UAAU,EAAE,EAAE,EAAG,CACzE,OAAQ,UAAW,MAAO,EAAG,OAAQ,GAAI,aAAc,GAAO,OAAQ,EACtE,WAAY,UAAW,UAAW,SACxC,CAAK,CACH,CACF,CAEO,SAASC,EAAoBJ,EAAM,CACxC,MAAMK,EAAO,SAAS,eAAe,cAAc,EACnD,GAAI,CAACA,EAAM,OACX,MAAMC,EAAMP,EAAiBC,CAAI,EACjCK,EAAK,UAAY;AAAA;AAAA;AAAA,qCAGkBC,CAAG;AAAA;AAAA;AAAA;AAAA;AAAA,YAMtC,MAAMC,EAAM,SAAS,eAAe,aAAa,EAC7CA,GAAKN,EAAcM,EAAKD,CAAG,CACjC,CAIO,SAASE,EAAcC,EAAcC,EAAK,CAC/C,IAAIC,EACJ,GAAID,EACFC,EAAQD,EAAI,IAAIE,GAAM,IAAI,KAAKC,GAAKA,EAAE,KAAOD,CAAE,CAAC,EAAE,OAAO,OAAO,UACvDH,GAAgB,IAAI,KAC7BE,EAAQ,CAAC,GAAG,GAAG,EAAE,IAAIC,GAAM,IAAI,KAAKC,GAAKA,EAAE,KAAOD,CAAE,CAAC,EAAE,OAAO,OAAO,MAChE,CAEL,MAAME,GAAK,SAAS,eAAe,WAAW,EAAE,OAAO,IAAI,YAAW,EACtEH,EAAQ,IAAI,OAAOE,GAAK,CACtB,MAAME,EAAK,CAACD,GAAKD,EAAE,KAAK,YAAW,EAAG,SAASC,CAAC,IAAMD,EAAE,KAAK,IAAI,YAAW,EAAG,SAASC,CAAC,EACnFE,EAAK,SAAS,OAAO,GAAK,aAAaH,CAAC,EAAE,KAAKI,GAAG,SAAS,IAAIA,CAAC,CAAC,EACjEC,GAAKL,EAAE,UAAU,IAAI,YAAW,EAAUM,EAAG,QAAQ,OAAO,GAAG,CAAC,GAAG,OAAO,EAAE,KAAKC,GAAGA,EAAE,YAAW,IAAKF,CAAG,EACzGG,EAAK,aAAa,QAAUR,EAAE,aAAa,MAAM,WACjDS,EAAM,gBAAgB,QAAUT,EAAE,SAAS,MAAM,cACvD,OAAOE,GAAIC,GAAIG,GAAIE,GAAIC,CACzB,CAAC,CACH,CACA,GAAI,CAACX,EAAM,OAAQ,CAAE,MAAM,oBAAqB,EAAI,EAAG,MAAQ,CAG/D,MAAMY,EAAeZ,EAAM,IAAIX,GAAQ,CACrC,MAAMM,EAAQP,EAAiBC,CAAI,EAC7BwB,EAAQ,IAAM,OAAOxB,EAAK,OAAO,CAAC,EAAE,QAAQ,CAAC,EAC7CyB,EAAU,cAAczB,CAAI,EAAE,CAAC,EACjC,8BAA8B,cAAcA,CAAI,EAAE,CAAC,CAAC,YACpD,GACE0B,EAAO,CAAC1B,EAAK,SAAUA,EAAK,YAAaA,EAAK,OAAO,EAAE,OAAO,OAAO,EAAE,KAAK,KAAK,EACvF,MAAO;AAAA,uCAC4BM,CAAG;AAAA,UAChCmB,CAAO;AAAA,+BACczB,EAAK,IAAI;AAAA,UAC9B0B,EAAO,uBAAuBA,CAAI,SAAW,EAAE;AAAA;AAAA,sCAEnB,aAAa1B,CAAI,EAAE,KAAK,KAAK,CAAC;AAAA,mCACjCwB,CAAK;AAAA;AAAA;AAAA,0CAGElB,CAAG;AAAA,gCACbA,CAAG;AAAA;AAAA,aAGjC,CAAC,EAAE,KAAK,EAAE,EAEJqB,EAAM,OAAO,KAAK,GAAI,SAAU,sBAAsB,EAC5DA,EAAI,SAAS,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BA8HShB,EAAM,MAAM,QAAQA,EAAM,SAAS,EAAE,IAAI,EAAE,gBAAgB,IAAI,KAAI,EAAG,mBAAmB,QAAQ,CAAC,MAAM,QAAQ,IAAI,UAAU,KAAK,SAAS,CAAC,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAOhJY,CAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA2BhC,EACNI,EAAI,SAAS,MAAK,CACpB"}